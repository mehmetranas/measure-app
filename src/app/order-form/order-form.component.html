<div class="order-info" *ngIf="order.id">
  <span class="title"><span class="font-weight-bold">Müşteri İsmi:&nbsp;</span> {{ customer.nameSurname }}</span>
  <div class="order-detail float-right">
    <span class="title"><span class="font-weight-bold">Sipariş Tarihi:&nbsp;</span> {{ order.orderDate| date: 'M/d/yy, HH:mm'}}</span>
    <span class="title"><span class="font-weight-bold">Sipariş Numarası:&nbsp;</span> {{ order.id}}</span>
  </div>
</div>
<mat-accordion>

  <!--All orderlines for current order-->
  <mat-expansion-panel *ngIf="customer.id">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Alınan Ölçüler
      </mat-panel-title>
      <mat-panel-description></mat-panel-description>
    </mat-expansion-panel-header>
    <app-orderlines  [orderlines]="orderlines"></app-orderlines>
    <mat-action-row>
      <button mat-button color="primary" (click)="completeOrder(0)">Sadece Kaydet</button>
      <ng-container *ngIf="orderlines.length>0">
        <button mat-button color="accent" (click)="completeOrder(2)">Sipariş Oluştur</button>
        <button mat-button color="warn" (click)="completeOrder(3)">Terziye Gönder</button>
      </ng-container>
    </mat-action-row>
  </mat-expansion-panel>

  <!--Create Customer and Initial new order-->
  <mat-expansion-panel [expanded]="stepper.count === 0" (opened)="stepper.count = 0">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Müşteri Bilgileri
      </mat-panel-title>
      <mat-panel-description>
        {{ customer.nameSurname }}
      </mat-panel-description>
    </mat-expansion-panel-header>
    <app-customer [customer]="customer" [order]="order" [stepper]="stepper"></app-customer>
  </mat-expansion-panel>

  <!--Add common fields of orderlineInProcess -->
  <mat-expansion-panel [expanded]="stepper.count === 1"
                       (opened)="stepper.count=1"
                       (closed)="orderlineformService.orderlineFormState.emit({measureFormClosed:true})"
                       *ngIf="customer.id">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Sipariş Detayı
      </mat-panel-title>
      <mat-panel-description *ngIf="orderline?.locationType">
        {{ locations[orderline.locationName]?.viewValue || 'Mekan Seçiniz' }} &nbsp; {{
        orderline.locationType}}
      </mat-panel-description>
    </mat-expansion-panel-header>
    <app-measure-form [order]="order" [globalForm]="form" (locationType)="getOrderlineProperties($event)"
                      [orderline]="orderline" [stepper]="stepper"></app-measure-form>
  </mat-expansion-panel>

  <!--Add specific fields of orderlineInProcess-->
  <mat-expansion-panel [expanded]="stepper.count === 2"
                       (opened)="stepper.count = 2"
                       *ngIf="customer.id">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Perde Detayı
      </mat-panel-title>
      <mat-panel-description>
        {{ orderlineProperties.name || 'Perde Türü Seçiniz' }}
      </mat-panel-description>
    </mat-expansion-panel-header>
    <app-dynamic-order-line [orderlineProperties]="orderlineProperties" [order]="order"
                            [orderline]="orderline" [orderlines]="orderlines"
                            [stepper]="stepper" [globalForm]="form"></app-dynamic-order-line>
  </mat-expansion-panel>

</mat-accordion>

